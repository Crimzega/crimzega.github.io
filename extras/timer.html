<!DOCTYPE html>
<html>
	<head>
		<title>Crimzega's AFK Clock</title>
		<style>
		html, body{
			height: 100%;
			width: 100%;
			margin: 0;
		}
		body{
			transition: background-color 1s;
		}
		.afk-time{
			font-family: "CS Mulan";
			font-size: 128px;
			left: 50%;
			position: fixed;
			top: 50%;
			transition: color 1s;
			transform: translate(-50%, -50%);
		}
		.afk-finish{
			font-size: 16px;
			left: 50%;
			position: fixed;
			top: 90%;
			transform: translate(-50%, -50%);
		}
		</style>
	</head>
	<body>
		<span class="afk-time">0</span>
		<button class="afk-finish">I have returned</button>
		<script src="../defs/core.js" type="module"></script>
		<script>
		(function(){
			var btnElem = document.querySelector('.afk-finish'), spanElem = document.querySelector('.afk-time');
			var clockActive = true, intervalID, origTime = new Date();
			
			var appendTime = () => {
				spanElem.innerHTML = SulvicUtils.convertToTimestamp(clockActive? new Date().getTime() - origTime.getTime(): 0);
				var color = Math.roundRange(0, 0xFFFFFF);
				spanElem.style.color = '#' + color.toString(16);
				document.body.style.backgroundColor = '#' + (color ^ 0xFFFFFF).toString(16);
			}
			
			var resetClock = () => {
				clearInterval(intervalID);
				appendTime();
			}
			
			var runClock = () => { appendTime(); }
			
			var updateInfo = () => {
				if(!clockActive) {
					btnElem.innerHTML = 'I must go';
					origTime = 0;
					resetClock();
				}
				else {
					btnElem.innerHTML = 'I have returned';
					origTime = new Date();
					intervalID = setInterval(runClock, 1000);
				}
			}
			
			btnElem.addEventListener('click', () => {
				clockActive = !clockActive;
				currTime = Date.now();
				updateInfo();
			});
			
			updateInfo();
		})();
		</script>
	</body>
</html>